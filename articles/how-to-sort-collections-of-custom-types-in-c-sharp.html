<!DOCTYPE HTML>
<html>
	<head>
		<title>nomad.uk.net</title>

		<meta name="author" content="Gary Willoughby">
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />

		<link rel="shortcut icon" href="/images/favicon.ico" />
		<link rel="stylesheet" type="text/css" href="/css/site.css">
		<link rel="stylesheet" type="text/css" href="/css/gist.css">
		<link rel="stylesheet" type="text/css" href="/css/disqus.css">
	</head>
	<body>
		<header>
			<div class="content">
				<table>
					<tr>
						<td class="logo">
							<a href="/"><h1>nomad<span class="highlight">software</span></h1></a>
						</td>
						<td class="links">
							<a title="Twitter" href="https://twitter.com/nomaddeveloper" target="_blank"><img src="/images/header/twitter.png" alt="Twitter"></a>
							<a title="Linkedin" href="http://uk.linkedin.com/pub/gary-willoughby/63/489/33b" target="_blank"><img src="/images/header/linkedin.png" alt="Linkedin"></a>
							<a title="Github" href="https://github.com/nomad-software" target="_blank"><img src="/images/header/github.png" alt="Github"></a>
						</td>
					</tr>
					<tr>
						<td colspan="2">
							<div class="nav-bar">
								<ul>
									<li><a href="/"><img src="/images/header/home.png" /></a></li>
									<li><a href="/pages/about.html">About</a></li>
									<li><a href="/pages/tools.html">Tools</a></li>
								</ul>
							</div>
						</td>
					</tr>
				</table>
			</div>
		</header>

		<div class="body">
			<div class="content">
				<div class="figure">
<img src="/articles/images/how-to-sort-collections-of-custom-types-in-c-sharp-banner.jpg" />

</div>
<h1 id="how-to-sort-collections-of-custom-types-in-c">How to sort collections of custom types in C</h1>
<p><time>Posted on 9th July 2013 by <a href="/pages/about.html">Gary Willoughby</a></time></p>
<p>Iâ€™ve recently created a program which sorts collections of custom types quite extensively and i thought iâ€™d share the standard method of doing this. When i first started designing my program, i honestly thought it would be quite a pain sorting these collections but i was pleasantly surprised, as usual by the .NET framework, that there are built in shortcuts.</p>
<h2 id="icomparable">IComparable</h2>
<p>The first stage to allow a custom type to be sorted is to implement the IComparable interface. This consists of one method <code>CompareTo&lt;T&gt;</code> where T is your custom type. This becomes your default comparer.</p>
<p>Hereâ€™s an example:</p>
<script src="https://gist.github.com/nomad-software/a5167f6b866338cd9dcb243f5e982ee0.js"></script>
<p>Once that method is implemented (here weâ€™ve implemented it using the name field to compare against) you can use the native sort methods on a collection of such types and have them sorted via this default comparer. For example if you are using an array as your collection, you can use the default static â€˜Sortâ€™ method to sort it:</p>
<script src="https://gist.github.com/nomad-software/7e54b8618213bd736ecd525078dddf81.js"></script>
<p>If you are using a generic list you can use the built in â€˜Sortâ€™ method:</p>
<script src="https://gist.github.com/nomad-software/33715f7cacbe80fbaed90d49881a5343.js"></script>
<p>Again this uses the default comparer and sorts the collection by the name field.</p>
<h2 id="comparison">Comparison</h2>
<p>If you need to give the user the option of multiple ways of sorting your collection you must implement other comparers. This is achieved by implementing Comparison delegates. Letâ€™s implement some in our custom type to allow sorting of every field:</p>
<script src="https://gist.github.com/nomad-software/c393b614afe0541b464b6388324ae920.js"></script>
<p>Here, as well as the default comparer, we have implemented three Comparison delegates to provide the rules of sorting the three fields in the custom type. They have been made static so you can use them without referring to an instance of the custom type.</p>
<p>Here is an example of sorting an array of our custom type by the Age field.</p>
<script src="https://gist.github.com/nomad-software/148edbfd338be90d9071c97ce875f9f8.js"></script>
<p>and here is how you sort a generic list collection by the Age field:</p>
<script src="https://gist.github.com/nomad-software/3701599a4aaf8d80c9a9d4d8dc18002d.js"></script>
<p>Simple.</p>
<p>Hopefully this gives you good grounding on sorting custom type collections and although there are other ways of sorting available in the .NET framework, these are the most common.</p>
															<div id="disqus_thread" class="disqus"></div>
						<script>
							var disqus_config = function() {
								this.page.url        = "http://nomad.uk.net/articles/how-to-sort-collections-of-custom-types-in-c-sharp.html";
								this.page.identifier = "6925fb89104afccfac623c5262b6ff6a";
							};

							(function() {
								var d = document;
								var s = d.createElement('script');
								s.src = 'https://nomad-software.disqus.com/embed.js';
								s.setAttribute('data-timestamp', +new Date());
								(d.head || d.body).appendChild(s);
							})();
						</script>
												</div>
		</div>

		<footer>
			<div class="content">
				<table>
					<tr>
						<td>
							<img src="https://s.gravatar.com/avatar/8b96f7858444f2ec6d364adfea854acc?s=80" class="thumb" />
						</td>
						<td>
							<p class="author">
								<strong>Author: Gary Willoughby</strong><br>
								Software engineer and published author with nearly twenty years experience of software design and development.
							</p>

							<div class="links">
								<a title="Twitter" href="https://twitter.com/nomaddeveloper" target="_blank"><img src="/images/header/twitter.png" alt="Twitter"></a>
								<a title="Linkedin" href="http://uk.linkedin.com/pub/gary-willoughby/63/489/33b" target="_blank"><img src="/images/header/linkedin.png" alt="Linkedin"></a>
								<a title="Github" href="https://github.com/nomad-software" target="_blank"><img src="/images/header/github.png" alt="Github"></a>
							</div>

							<p class="copyright">
								Content copyright &copy; 2017 Gary Willoughby All Rights Reserved.
								All source code is public domain and provided "as is", so use at your own risk.
								All content previously appeared at <a href="http://nomad.so/" target="_blank">www.nomad.so</a> and carefully migrated here because the somalis wanted their domain back! ðŸ˜ž
							</p>
						</td>
					</tr>
				</table>
			</div>
		</footer>
	</body>
</html>
